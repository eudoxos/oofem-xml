<oofem version="1">
  <Output>control_switch_2.out</Output>
  <Description>Test of nonproportional loading and solution control switching</Description>
  <!-- rectangular specimen -->
  <!-- 4&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;3 -->
  <!-- |                  | -->
  <!-- 1&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;2 -->
  <!-- time 0 - loaded in x direction under indirect control, controlled displacements of nodes 2,3 -->
  <!-- time 1 - loaded in y direction (loaded nodes 3 4) with direct control -->
  <!-- time 2 - unloaded in x direction under direct displ. control -->
  <!-- time 3 - unloaded in y direction with indirect control -->
  <!-- result - the return to original unloaded state -->
  <Analysis type="NonLinearStatic" nsteps="4">
    <Metasteps>
      <Metastep nsteps="1" controlmode="0" steplength="2.5" rtolf="0.0001" maxiter="2000" psi="0.0" reqiterations="80" hpc="2 1" refloadmode="0"/>
      <Metastep nsteps="1" controlmode="1" rtolf="0.0001" maxiter="2000" stiffmode="1" refloadmode="0"/>
      <Metastep nsteps="1" controlmode="1" rtolf="0.0001" maxiter="2000" stiffmode="1" ddm="2 1 3 1" ddv="-2.5 -2.5" ddltf="3" refloadmode="0"/>
      <Metastep nsteps="1" controlmode="0" steplength="0.66666674" rtolf="0.0001" maxiter="2000" stiffmode="1" psi="0.0" hpc="3 2" refloadmode="0"/>
    </Metasteps>
  </Analysis>
  <Domain domain="2dplanestress">
    <OutputManager tstep_all="" dofman_all="" element_all=""/>
    <Nodes>
      <Node coords="0.0 0.0 0.0"/>
      <Node coords="4.0 0.0 0.0"/>
      <Node coords="4.0 3.0 0.0"/>
      <Node coords="0.0 3.0 0.0"/>
    </Nodes>
    <Elements>
      <PlaneStress2d nodes="1 2 3 4"/>
    </Elements>
    <CrossSections>
      <SimpleCS thick="0.15" material="1" set="1"/>
    </CrossSections>
    <Materials>
      <IsoLE talpha="1.2e-05" d="1.0" e="15.0" n="0.25"/>
    </Materials>
    <BoundaryConditions>
      <BoundaryCondition loadtimefunction="1" dofs="1" values="0.0" set="4"/>
      <BoundaryCondition loadtimefunction="1" dofs="2" values="0.0" set="5"/>
      <NodalLoad loadtimefunction="2" dofs="1 2" components="2.0 0.0" set="2"/>
      <NodalLoad loadtimefunction="4" dofs="1 2" components="0.0 1.0" set="3"/>
      <NodalLoad id="5" loadtimefunction="5" dofs="1 2" components="0.0 -1.0" set="3"/>
    </BoundaryConditions>
    <InitialConditions/>
    <LoadTimeFunctions>
      <ConstantFunction f_t_="1.0"/>
      <PeakFunction t="0.0" f_t_="1.0"/>
      <PeakFunction t="2.0" f_t_="1.0"/>
      <PeakFunction t="1.0" f_t_="1.0"/>
      <PeakFunction id="5" t="3.0" f_t_="1.0"/>
    </LoadTimeFunctions>
    <Sets>
      <Set elementranges="1"/>
      <Set nodes="2 3"/>
      <Set nodes="3 4"/>
      <Set nodes="1 4"/>
      <Set id="5" nodes="1 2"/>
    </Sets>
  </Domain>
  <ExportModules>
    <errorcheck tolerance="2e-06">
      <!-- check reactions -->
      <REACTION tStep="4" number="1" dof="1" value="0.0"/>
      <REACTION tStep="4" number="1" dof="2" value="0.0"/>
      <REACTION tStep="4" number="2" dof="2" value="0.0"/>
      <REACTION tStep="4" number="4" dof="1" value="0.0"/>
      <!-- check all nodes -->
      <NODE tStep="4" number="1" dof="1" unknown="d" value="0.0"/>
      <NODE tStep="4" number="1" dof="2" unknown="d" value="0.0"/>
      <NODE tStep="4" number="2" dof="1" unknown="d" value="0.0"/>
      <NODE tStep="4" number="2" dof="2" unknown="d" value="0.0"/>
      <NODE tStep="4" number="3" dof="1" unknown="d" value="0.0"/>
      <NODE tStep="4" number="3" dof="2" unknown="d" value="0.0"/>
      <NODE tStep="4" number="4" dof="1" unknown="d" value="0.0"/>
      <NODE tStep="4" number="4" dof="2" unknown="d" value="0.0"/>
      <!-- check element strain vector -->
      <ELEMENT tStep="4" number="1" gp="1" keyword="4" component="1" value="0.0"/>
      <ELEMENT tStep="4" number="1" gp="1" keyword="4" component="2" value="0.0"/>
      <ELEMENT tStep="4" number="1" gp="1" keyword="4" component="6" value="0.0"/>
      <!-- check element stress vector -->
      <ELEMENT tStep="4" number="1" gp="1" keyword="1" component="1" value="0.0"/>
      <ELEMENT tStep="4" number="1" gp="1" keyword="1" component="2" value="0.0"/>
      <ELEMENT tStep="4" number="1" gp="1" keyword="1" component="6" value="0.0"/>
    </errorcheck>
  </ExportModules>
</oofem>
